<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>P2P-CARS - Déposer une annonce de vente</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
    <!-- Remplacez ci-dessous par le chemin vers votre CSS généré par Tailwind -->
    <!-- Compilez avec: npx tailwindcss -i ./src/input.css -o ./dist/output.css --minify -->
    <link rel="stylesheet" href="dist/output.css">
    <style>
        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0;}
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(to bottom, #0f172a, #1e293b), url('arier.png') no-repeat center center fixed;
            background-size: cover;
            color: #e2e8f0;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
        }
        header {
            background: rgba(255,255,255,0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.05);
            border-radius: 16px;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            margin-bottom: 20px;
        }
        header img { max-height: 80px; object-fit: contain; transition: transform 0.3s;}
        header img:hover { transform: scale(1.05);}
        header h1 { font-size: 2rem; font-weight: 700; color: #3b82f6; text-align: center;}
        .lang-btns { display: flex; justify-content: center; gap: 1rem; margin-bottom: 1rem;}
        .lang-btns button {
            background: #3b82f6; color: #fff; border: none; border-radius: 8px; padding: 8px 18px;
            font-weight: 500; cursor: pointer;
            transition: background 0.3s;
        }
        .lang-btns button:hover { background: #2563eb;}
        .form-section {
            background: rgba(255,255,255,0.05);
            backdrop-filter: blur(12px);
            border-radius: 18px;
            max-width: 600px;
            margin: auto;
            box-shadow: 0 8px 24px rgba(0,0,0,0.25);
            padding: 32px 24px;
            margin-bottom: 30px;
        }
        .form-section h2 { font-size: 2rem; color: #fff; margin-bottom: 20px; text-align: center;}
        form label { font-weight: 500; margin-bottom: 3px;}
        form input, form select, form textarea {
            width: 100%;
            padding: 10px;
            margin-bottom: 14px;
            background: #1e293b;
            color: #e2e8f0;
            border: 1px solid #334155;
            border-radius: 8px;
            font-size: 1rem;
        }
        form textarea { min-height: 60px; }
        form input[type="file"] { background: transparent; border: none; color: #e2e8f0;}
        form button[type="submit"] {
            background: #3b82f6; color: #fff; border: none; border-radius: 8px;
            font-size: 1.1rem; font-weight: 600; padding: 12px 28px;
            cursor: pointer; margin-top: 10px;
            transition: background 0.3s;
        }
        form button[type="submit"]:hover { background: #2563eb;}
        #result { text-align: center; margin-top: 12px; font-weight: 600;}
        @media (max-width: 768px) {
            header { flex-direction: column; text-align: center;}
            header img { max-width: 60%;}
            .form-section { padding: 16px 5px;}
        }
    </style>
</head>
<body>

<header>
    <img src="logo1.png" alt="Logo société mère">
    <div>
        <h1>P2P-CARS</h1>
        <p class="text-h">Plateforme de Voitures d'Occasion</p>
    </div>
    <img src="logo4.png" alt="Logo plateforme">
</header>

<div class="lang-btns">
    <button type="button" onclick="setLang('fr')">Français</button>
    <button type="button" onclick="setLang('en')">English</button>
    <button type="button" onclick="setLang('ar')">العربية</button>
</div>

<section class="form-section">
    <h2 id="form-title">Déposer une annonce de vente</h2>
    <form id="annonceForm" enctype="multipart/form-data">
        <label id="lbl-marque">Marque:
            <select name="marque" id="marque" required>
                <option value="">--Choisir--</option>
                <option value="Renault">Renault</option>
                <option value="Peugeot">Peugeot</option>
                <option value="Citroën">Citroën</option>
                <option value="Volkswagen">Volkswagen</option>
                <option value="Toyota">Toyota</option>
            </select>
        </label>
        <label id="lbl-modele">Modèle:
            <select name="modele" id="modele" required>
                <option value="">--Choisir--</option>
            </select>
        </label>
        <label id="lbl-annee">Année:
            <select name="annee" id="annee" required>
                <option value="">--Choisir--</option>
            </select>
        </label>
        <label id="lbl-prix">Prix (€): <input name="prix" type="number" required min="0"></label>
        <label id="lbl-kilometrage">Kilométrage: <input name="kilometrage" type="number" required min="0"></label>
        <label id="lbl-carburant">Carburant:
            <select name="carburant" required>
                <option value="Essence">Essence</option>
                <option value="Diesel">Diesel</option>
                <option value="Electrique">Electrique</option>
                <option value="Hybride">Hybride</option>
            </select>
        </label>
        <label id="lbl-transmission">Transmission:
            <select name="transmission" required>
                <option value="Manuelle">Manuelle</option>
                <option value="Automatique">Automatique</option>
            </select>
        </label>
        <label id="lbl-description">Description: <textarea name="description" required></textarea></label>
        <label id="lbl-email">Votre email: <input name="email" type="email" required></label>
        <label id="lbl-images">Images (max 10): <input name="images" type="file" accept="image/*" multiple required></label>
        <button type="submit" id="btn-submit">Envoyer</button>
    </form>
    <div id="result"></div>
</section>

<footer style="background:rgba(255,255,255,0.05);border-radius:12px;padding:16px;text-align:center;color:#94a3b8;font-size:0.9rem;box-shadow:0 -2px 10px rgba(0,0,0,0.25);margin-top:auto;">
    &copy; 2025 Plateforme de Voitures d'Occasion. Tous droits réservés.
</footer>

<script>
    // Populate année dropdown
    const anneeSelect = document.getElementById('annee');
    for(let y=2025; y>=2000; y--) {
        let opt = document.createElement('option');
        opt.value = y; opt.textContent = y;
        anneeSelect.appendChild(opt);
    }

    // Modèles dynamiques
    const modeleData = {
        Renault: ["Clio", "Captur", "Mégane"],
        Peugeot: ["208", "2008", "308"],
        Citroën: ["C3", "C4", "C5"],
        Volkswagen: ["Golf", "Polo", "Passat"],
        Toyota: ["Yaris", "Corolla", "RAV4"]
    };
    document.getElementById('marque').addEventListener('change', function(){
        const marque = this.value;
        const modeleSelect = document.getElementById('modele');
        modeleSelect.innerHTML = '<option value="">--Choisir--</option>';
        if(modeleData[marque]){
            modeleData[marque].forEach(m => {
                let opt = document.createElement('option');
                opt.value = m; opt.textContent = m;
                modeleSelect.appendChild(opt);
            });
        }
    });

    // Traduction simple : titres, labels, bouton
    const translations = {
        fr: {
            titre: "Déposer une annonce de vente",
            marque: "Marque:",
            modele: "Modèle:",
            annee: "Année:",
            prix: "Prix (€):",
            kilometrage: "Kilométrage:",
            carburant: "Carburant:",
            transmission: "Transmission:",
            description: "Description:",
            email: "Votre email:",
            images: "Images (max 10):",
            envoyer: "Envoyer"
        },
        en: {
            titre: "Post a car ad",
            marque: "Brand:",
            modele: "Model:",
            annee: "Year:",
            prix: "Price (€):",
            kilometrage: "Mileage:",
            carburant: "Fuel:",
            transmission: "Transmission:",
            description: "Description:",
            email: "Your email:",
            images: "Images (max 10):",
            envoyer: "Send"
        },
        ar: {
            titre: "إيداع إعلان سيارة",
            marque: "الماركة:",
            modele: "الموديل:",
            annee: "السنة:",
            prix: "السعر (€):",
            kilometrage: "الكيلومترات:",
            carburant: "الوقود:",
            transmission: "ناقل الحركة:",
            description: "الوصف:",
            email: "البريد الإلكتروني:",
            images: "صور (10 كحد أقصى):",
            envoyer: "إرسال"
        }
    };
    function setLang(lang) {
        document.getElementById('form-title').textContent = translations[lang].titre;
        document.getElementById('lbl-marque').childNodes[0].textContent = translations[lang].marque;
        document.getElementById('lbl-modele').childNodes[0].textContent = translations[lang].modele;
        document.getElementById('lbl-annee').childNodes[0].textContent = translations[lang].annee;
        document.getElementById('lbl-prix').childNodes[0].textContent = translations[lang].prix;
        document.getElementById('lbl-kilometrage').childNodes[0].textContent = translations[lang].kilometrage;
        document.getElementById('lbl-carburant').childNodes[0].textContent = translations[lang].carburant;
        document.getElementById('lbl-transmission').childNodes[0].textContent = translations[lang].transmission;
        document.getElementById('lbl-description').childNodes[0].textContent = translations[lang].description;
        document.getElementById('lbl-email').childNodes[0].textContent = translations[lang].email;
        document.getElementById('lbl-images').childNodes[0].textContent = translations[lang].images;
        document.getElementById('btn-submit').textContent = translations[lang].envoyer;
        document.documentElement.lang = lang;
        // Optionnel : changer la direction pour l'arabe
        if(lang === 'ar'){ document.body.style.direction = "rtl"; }
        else { document.body.style.direction = "ltr";}
    }

    document.getElementById('annonceForm').addEventListener('submit', async function(e) {
        e.preventDefault();
        const form = e.target;
        const data = new FormData(form);

        if (data.getAll('images').length > 10) {
            document.getElementById('result').textContent = "Maximum 10 images autorisées.";
            return;
        }
        // Changez ici l’URL pour pointer vers votre serveur derrière Cloudflare Tunnel
        try {
            const response = await fetch('https://api.p2p-cars.com', {
                method: 'POST',
                body: data
            });
            if (response.ok) {
                document.getElementById('result').textContent = "Annonce envoyée !";
                form.reset();
            } else {
                // Affiche le code erreur et un message explicite
                document.getElementById('result').textContent =
                  "Erreur lors de l’envoi ("+response.status+"). " +
                  (response.status === 404
                    ? "API introuvable (404). Vérifiez l'URL."
                    : "Problème serveur ou CORS. Voir console.");
            }
        } catch (err) {
            // Gère les erreurs réseau/CORS
            document.getElementById('result').textContent =
              "Erreur réseau/CORS : impossible de contacter l’API. Vérifiez le serveur.";
            console.error('Erreur requête API:', err);
        }
    });
</script>

</body>
</html>
