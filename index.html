<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>P2P-CARS - Trouvez Votre Voiture d'Occasion Idéale</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"/>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
  <style>
    /* ... styles identique à la page précédente ... */
    body {
        background: linear-gradient(to bottom, rgba(15, 23, 42, 0.301), rgba(30, 41, 59, 0.247)),
        url('arier.png') no-repeat center center fixed;
        background-size: cover;
        color: #e2e8f0;
        font-family: 'Poppins', sans-serif;
        min-height: 100vh;
        padding: 0;
        margin: 0;
        display: flex;
        flex-direction: column;
    }
    header {
      background: rgba(255,255,255,0.07);
      backdrop-filter: blur(10px);
      border-radius: 15px;
      padding: 18px;
      display: flex;
      justify-content: center;
      align-items: center;
      margin: 14px 10px 20px 10px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.35);
      gap: 40px;
    }
    header img {
      max-height: 110px;
      width: auto;
      object-fit: contain;
      transition: transform 0.3s;
    }
    header img:hover { transform: scale(1.05);}
    header .header-center {
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
    }
    header h1 {
      font-size: 2.4rem;
      font-weight: 700;
      color: #e98a1e;
      margin-bottom: 0.3em;
    }
    header .text-h {
      font-size: 1.1rem;
      color: #effafa;
      letter-spacing: 0.5px;
    }
    @media (max-width: 750px) {
      header { flex-direction: column; gap: 12px;}
      header img { max-width: 70%;}
    }
    .navbar {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 1rem;
      margin-top: 1rem;
      justify-content: center;
    }
    .lang-btns {
      display: flex;
      gap: 0.5rem;
      align-items: center;
    }
    .lang-btns button {
      width: 34px; height: 34px;
      border-radius: 50%;
      border: 2px solid #3b82f6;
      background: #1e293b;
      color: #3b82f6;
      font-weight: bold;
      cursor: pointer;
      display: flex; align-items: center; justify-content: center;
      transition: background 0.3s;
      font-size: 1rem;
    }
    .lang-btns button.active, .lang-btns button:hover { background: #3b82f6; color: #fff;}
    .home-btn {
      margin-left: 0.7rem;
      background: #fff;
      color: #1e293b;
      border-radius: 20px;
      padding: 8px 16px;
      border: none;
      font-weight: 600;
      font-size: 1rem;
      text-decoration: none;
      box-shadow: 0 2px 4px rgba(0,0,0,0.07);
      transition: background 0.2s, color 0.2s;
    }
    .home-btn:hover { background: #3b82f6; color: #fff;}
    footer {
      text-align:center;
      margin: 20px 0 0 0;
      color: #e2e8f0;
      background: rgba(255,255,255,0.06);
      border-radius: 15px;
      box-shadow: 0 -2px 10px rgba(0,0,0,0.15);
      padding: 16px;
      font-size: 0.97rem;
    }
    .header-nav {
        background: rgba(255, 255, 255, 0.05);
        backdrop-filter: blur(10px);
        padding: 12px 20px;
        border-radius: 12px;
        display: flex;
        justify-content: center;
        flex-wrap: wrap;
        gap: 15px;
        margin-bottom: 30px;
    }
    .header-nav a {
        color: #3bf6e6;
        font-weight: 500;
        text-decoration: none;
        padding: 10px 16px;
        border-radius: 8px;
        transition: background 0.3s ease;
    }
    .header-nav a:hover {
        background: rgba(115, 59, 246, 0.562);
    }
    .welcome-section {
        background: rgba(255, 255, 255, 0.05);
        backdrop-filter: blur(12px);
        padding: 40px 30px;
        border-radius: 16px;
        text-align: center;
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.25);
        margin-bottom: 30px;
        transition: transform 0.3s ease;
    }
    .welcome-section:hover {
        transform: translateY(-5px);
    }
    .welcome-section h2 {
        font-size: 2.5rem;
        font-weight: 700;
        color: #3b82f6;
        margin-bottom: 15px;
    }
    .welcome-section p {
        font-size: 1.2rem;
        color: #eaecf0;
        margin-bottom: 25px;
    }
    .welcome-section button {
        background: #3b82f6;
        color: #ffffff;
        font-size: 1.1rem;
        font-weight: 600;
        padding: 12px 28px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        transition: background 0.3s ease, transform 0.2s ease;
    }
    .welcome-section button:hover {
        background: #2563eb;
        transform: scale(1.05);
    }
    .filters {
        background: rgba(255, 255, 255, 0.03);
        backdrop-filter: blur(10px);
        padding: 20px;
        border-radius: 12px;
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
        gap: 15px;
        margin-bottom: 30px;
        color: #e2e8f0;
    }
    .filters label {
        font-size: 0.9rem;
        margin-bottom: 4px;
        display: block;
    }
    .filters input,
    .filters select {
        padding: 10px;
        background: #1e293b;
        color: #e2e8f0;
        border: 1px solid #3b82f6;
        border-radius: 8px;
        font-size: 0.95rem;
    }
    .filters input:focus,
    .filters select:focus {
        outline: none;
        border-color: #3b82f6;
    }
    .car-list {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 25px;
    }
    .car {
        background: #1e293b;
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        transition: transform 0.3s ease;
    }
    .car:hover {
        transform: scale(1.02);
    }
    .car img {
        width: 100%;
        height: 200px;
        object-fit: cover;
    }
    .car-details {
        padding: 20px;
    }
    .car h3 {
        font-size: 1.4rem;
        color: #ffffff;
        margin-bottom: 10px;
    }
    .car p {
        font-size: 0.95rem;
        color: #cbd5e1;
        margin-bottom: 6px;
    }
    .car button {
        background: #3b82f6;
        color: #ffffff;
        border: none;
        border-radius: 6px;
        padding: 10px 20px;
        font-weight: 500;
        cursor: pointer;
        transition: background 0.3s ease;
    }
    .car button:hover {
        background: #2563eb;
    }
    @media (max-width: 768px) {
        header { flex-direction: column; text-align: center;}
        header img { max-width: 68%;}
        .header-nav { flex-direction: column; gap: 10px;}
        .filters { grid-template-columns: 1fr; }
        .car img { height: 160px; }
    }
  </style>
</head>
<body>
<header>
  <img src="logo1.png" alt="Logo société mère">
  <div class="header-center">
    <h1>P2P-CARS</h1>
    <p class="text-h">Plateforme de Voitures d'Occasion</p>
  </div>
  <img src="logo4.png" alt="Logo plateforme">
</header>
<div class="navbar">
  <div class="lang-btns">
    <button id="lang-fr" onclick="setLang('fr')" aria-label="Français">FR</button>
    <button id="lang-en" onclick="setLang('en')" aria-label="English">EN</button>
    <button id="lang-ar" onclick="setLang('ar')" aria-label="العربية">AR</button>
  </div>
  <a href="https://p2p-cars.com" class="home-btn"><i class="fas fa-home"></i> Accueil</a>
</div>
<nav class="header-nav">
    <a href="https://p2p-cars.com" id="nav-accueil">Accueil</a>
    <a href="https://p2p-cars.com/esprix" id="nav-simulateur">Simulateur Prix</a>
    <a href="https://p2p-cars.com/carservices" id="nav-services">Services P2P-Cars</a>
    <a href="https://p2p-cars.com/login" id="nav-login">Espace personnel </a>
</nav>
<section class="welcome-section" id="welcome-section">
    <h2 id="welcome-title">Bienvenue sur P2P-CARS</h2>
    <p id="welcome-desc">Découvrez ici les meilleures offres de voitures d'occasion, annoncez la vente de la vôtre en toute simplicité, ou demandez à trouver et à acheter précisément la voiture d'occasion qui correspond à vos besoins. Profitez également d’un service complet, avant et après la vente ou l’achat, entièrement adapté à vos attentes. Et pour faciliter votre acquisition, bénéficiez de plans de paiement flexibles, le tout dans un cadre de confiance entre particuliers.</p>
    <button id="btn">Envoyer une demande</button>
</section>
<section class="filters">
    <label for="search" id="filter-search-label">Rechercher:</label>
    <input type="text" id="search" placeholder="Rechercher...">
    <label for="marque" id="filter-marque-label">Marque:</label>
    <select id="marque"></select>
    <label for="modele" id="filter-modele-label">Modèle:</label>
    <select id="modele"></select>
    <label for="annee" id="filter-annee-label">Année:</label>
    <select id="annee"></select>
    <label for="kilometrage" id="filter-kilometrage-label">Kilométrage max:</label>
    <input type="number" id="kilometrage" placeholder="Kilométrage max">
    <label for="carburant" id="filter-carburant-label">Carburant:</label>
    <select id="carburant"></select>
    <label for="puissance" id="filter-puissance-label">Puissance max (CV):</label>
    <input type="number" id="puissance" placeholder="Puissance max (CV)">
</section>
<section class="car-list" id="carList">
    <!-- Car listings will be dynamically added here -->
</section>
<footer>
  &copy; 2025 IASMarket Services. Tous droits réservés.
</footer>
<!-- Modal structure -->
<div id="modal-bg" style="display:none"></div>
<script>
const apiURL = "https://apicars.p2p-cars.com/api/getannonce";
const imgBase = "https://apicars.p2p-cars.com/";

const translations = {
  fr: {
    // ... (identique à avant) ...
    'consult-btn': "Consulter",
    'modal-title': "Détails de la voiture",
    'modal-close': "Fermer",
    'modal-contact': "Contacter le vendeur",
    'modal-buy': "Demander l'achat P2P",
    'modal-date': "Date de mise en ligne",
    'modal-marque': "Marque",
    'modal-modele': "Modèle",
    'modal-annee': "Année",
    'modal-puissance': "Puissance fiscale",
    'modal-kilometrage': "Kilométrage",
    'modal-carburant': "Carburant",
    'modal-transmission': "Transmission",
    'modal-desc': "Description",
    'modal-price': "Prix"
  },
  en: {
    // ... (identique à avant) ...
    'consult-btn': "View details",
    'modal-title': "Car details",
    'modal-close': "Close",
    'modal-contact': "Contact seller",
    'modal-buy': "Request P2P purchase",
    'modal-date': "Online since",
    'modal-marque': "Brand",
    'modal-modele': "Model",
    'modal-annee': "Year",
    'modal-puissance': "Fiscal power",
    'modal-kilometrage': "Mileage",
    'modal-carburant': "Fuel",
    'modal-transmission': "Transmission",
    'modal-desc': "Description",
    'modal-price': "Price"
  },
  ar: {
    // ... (identique à avant) ...
    'consult-btn': "معاينة التفاصيل",
    'modal-title': "تفاصيل السيارة",
    'modal-close': "إغلاق",
    'modal-contact': "اتصل بالبائع",
    'modal-buy': "طلب شراء P2P",
    'modal-date': "تاريخ النشر",
    'modal-marque': "الماركة",
    'modal-modele': "الموديل",
    'modal-annee': "السنة",
    'modal-puissance': "القوة الجبائية",
    'modal-kilometrage': "الكيلومترات",
    'modal-carburant': "الوقود",
    'modal-transmission': "ناقل الحركة",
    'modal-desc': "الوصف",
    'modal-price': "السعر"
  }
};

// ... (Code de gestion de la langue existant) ...

let currentLang = "fr";
function setLang(lang) {
  // ... (Code existant) ...
  displayCars();
}
function fillModelSelect() {
  // ... (Code existant) ...
}
function displayCars() {
  // Ajoute l'appel à fetch ici
  fetch(apiURL)
    .then(res => res.json())
    .then(data => {
      if (!Array.isArray(data)) return;
      const cars = data;
      const list = document.getElementById("carList");
      const search = document.getElementById("search").value.toLowerCase();
      const marque = document.getElementById("marque").value;
      const modele = document.getElementById("modele").value;
      const annee = document.getElementById("annee").value;
      const kilometrage = document.getElementById("kilometrage").value;
      const carburant = document.getElementById("carburant").value;
      const puissance = document.getElementById("puissance").value;
      // Filtre
      const filtered = cars.filter(c => {
        return (
          (search === "" || c.marque?.toLowerCase().includes(search) || c.modele?.toLowerCase().includes(search)) &&
          (marque === "" || c.marque === marque) &&
          (modele === "" || c.modele === modele) &&
          (annee === "" || c.annee == annee) &&
          (kilometrage === "" || c.kilometrage <= parseInt(kilometrage || Infinity)) &&
          (carburant === "" || c.carburant === carburant) &&
          (puissance === "" || c.puissance_fiscal <= parseInt(puissance || Infinity))
        );
      });
      list.innerHTML = "";
      filtered.forEach(c => {
        const div = document.createElement("div");
        div.className = "car";
        // Pour l'image on prend la première
        let imagesArr = Array.isArray(c.images) ? c.images : (typeof c.images === "string" ? c.images.split(",") : []);
        let imgLink = imagesArr.length > 0 ? imgBase + imagesArr[0].replace(/\\/g,"/") : "images/default.jpg";
        div.innerHTML = `
          <img src="${imgLink}" alt="${c.marque} ${c.modele}">
          <div class="car-details">
            <h3>${c.marque || ""} ${c.modele || ""} (${c.annee || ""})</h3>
            <p><strong>${translations[currentLang]['modal-kilometrage']}</strong> ${c.kilometrage || ""} km</p>
            <p><strong>${translations[currentLang]['modal-carburant']}</strong> ${c.carburant || ""}</p>
            <p><strong>${translations[currentLang]['modal-puissance']}</strong> ${c.puissance_fiscal || ""}</p>
            <p><strong>${translations[currentLang]['modal-price']}</strong> ${c.prix ? c.prix + " €" : ""}</p>
            <p>${c.description || ""}</p>
            <button class="consult-btn" data-index="${c.Ref_annonce}" style="margin-top:8px;">${translations[currentLang]['consult-btn']}</button>
          </div>
        `;
        list.appendChild(div);
        div.querySelector(".consult-btn").addEventListener("click", ()=>openModal(c));
      });
    })
    .catch(() => {
      // fallback exemple si erreur API
      fallbackDisplayCars();
    });
}
function fallbackDisplayCars() {
  // Utilise l'exemple statique si l'API ne répond pas
  const cars = translations[currentLang]['cars'];
  const list = document.getElementById("carList");
  const search = document.getElementById("search").value.toLowerCase();
  const marque = document.getElementById("marque").value;
  const modele = document.getElementById("modele").value;
  const annee = document.getElementById("annee").value;
  const kilometrage = document.getElementById("kilometrage").value;
  const carburant = document.getElementById("carburant").value;
  const puissance = document.getElementById("puissance").value;
  const filtered = cars.filter(c => {
    return (
      (search === "" || c.marque.toLowerCase().includes(search) || c.modele.toLowerCase().includes(search)) &&
      (marque === "" || c.marque === marque) &&
      (modele === "" || c.modele === modele) &&
      (annee === "" || c.annee === annee) &&
      (kilometrage === "" || c.kilometrage <= parseInt(kilometrage || Infinity)) &&
      (carburant === "" || c.carburant === carburant) &&
      (puissance === "" || c.puissance <= parseInt(puissance || Infinity))
    );
  });
  list.innerHTML = "";
  filtered.forEach(c => {
    const div = document.createElement("div");
    div.className = "car";
    div.innerHTML = `
      <img src="${c.image}" alt="${c.marque} ${c.modele}">
      <div class="car-details">
        <h3>${c.marque} ${c.modele} (${c.annee})</h3>
        <p><strong>${translations[currentLang]['filter-kilometrage-label']}</strong> ${c.kilometrage} km</p>
        <p><strong>${translations[currentLang]['filter-carburant-label']}</strong> ${c.carburant}</p>
        <p><strong>${translations[currentLang]['filter-puissance-label']}</strong> ${c.puissance}</p>
        <p>${c.description}</p>
        <button class="consult-btn">${translations[currentLang]['consult-btn']}</button>
      </div>
    `;
    list.appendChild(div);
    div.querySelector(".consult-btn").addEventListener("click", ()=>openModal(c));
  });
}

// MODAL LOGIC
function openModal(car) {
  let imagesArr = Array.isArray(car.images) ? car.images : (typeof car.images === "string" ? car.images.split(",") : []);
  let imagesHtml = imagesArr.map(img=>`<img src="${imgBase + img.replace(/\\/g,"/")}" alt="Car image">`).join('');
  let priceStr = car.prix ? car.prix + " €" : "";
  let modalBg = document.getElementById("modal-bg");
  modalBg.innerHTML = `
    <div class="modal">
      <button class="modal-close" aria-label="${translations[currentLang]['modal-close']}">&times;</button>
      <h2>${translations[currentLang]['modal-title']}</h2>
      <div class="modal-images">${imagesHtml}</div>
      <div class="modal-details">
        <p><strong>${translations[currentLang]['modal-date']}:</strong> ${car.date_mise_en_ligne || ""}</p>
        <p><strong>${translations[currentLang]['modal-marque']}:</strong> ${car.marque || ""}</p>
        <p><strong>${translations[currentLang]['modal-modele']}:</strong> ${car.modele || ""}</p>
        <p><strong>${translations[currentLang]['modal-annee']}:</strong> ${car.annee || ""}</p>
        <p><strong>${translations[currentLang]['modal-puissance']}:</strong> ${car.puissance_fiscal || ""}</p>
        <p><strong>${translations[currentLang]['modal-kilometrage']}:</strong> ${car.kilometrage || ""} km</p>
        <p><strong>${translations[currentLang]['modal-carburant']}:</strong> ${car.carburant || ""}</p>
        <p><strong>${translations[currentLang]['modal-transmission']}:</strong> ${car.transmission || ""}</p>
        <p><strong>${translations[currentLang]['modal-desc']}:</strong> ${car.description || ""}</p>
        <p><strong>${translations[currentLang]['modal-price']}:</strong> ${priceStr}</p>
      </div>
      <div class="modal-actions">
        <button id="contact-btn">${translations[currentLang]['modal-contact']}</button>
        <button id="buy-btn">${translations[currentLang]['modal-buy']}</button>
      </div>
    </div>
  `;
  modalBg.style.display = "flex";
  // Fermeture
  modalBg.querySelector(".modal-close").onclick = function() { modalBg.style.display = "none"; };
  modalBg.onclick = function(e) {
    if (e.target === modalBg) modalBg.style.display = "none";
  };
  // Action boutons
  document.getElementById("contact-btn").onclick = function() {
    // Remplacer par votre logique d'envoi/affichage formulaire contact
    window.location.href = "mailto:contact@p2p-cars.com?subject=Contact vendeur Ref " + (car.Ref_annonce || "");
  };
  document.getElementById("buy-btn").onclick = function() {
    // Remplacer par la logique d'achat, ici redirige vers le service avec ref annonce
    window.location.href = "https://p2p-cars.com/carservices?buy=" + encodeURIComponent(car.Ref_annonce || "");
  };
}

// Listeners
document.getElementById("marque").addEventListener("change", () => {
  fillModelSelect();
  displayCars();
});
document.getElementById("modele").addEventListener("change", displayCars);
document.getElementById("annee").addEventListener("change", displayCars);
document.getElementById("kilometrage").addEventListener("input", displayCars);
document.getElementById("carburant").addEventListener("change", displayCars);
document.getElementById("puissance").addEventListener("input", displayCars);
document.getElementById("search").addEventListener("input", displayCars);
['fr','en','ar'].forEach(l=>{
  document.getElementById('lang-'+l).addEventListener('click', ()=>setLang(l));
});
// Initialisation
setLang('fr');
document.getElementById('btn').addEventListener('click', function() {
  window.location.href = 'https://p2p-cars.com/carservices';
});
</script>
</body>
</html>
</html>
